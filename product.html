
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المنتجات - البيت الدمشقي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap');
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f9f7f4;
        }
        
        .arabic-pattern {
            background-image: url("data:image/svg+xml,%3Csvg width='42' height='44' viewBox='0 0 42 44' xmlns='http://www.w3.org/2000/svg'%3E%3Cg id='Page-1' fill='none' fill-rule='evenodd'%3E%3Cg id='brick-wall' fill='%23a17a50' fill-opacity='0.15'%3E%3Cpath d='M0 0h42v44H0V0zm1 1h40v20H1V1zM0 23h20v20H0V23zm22 0h20v20H22V23z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        .section-heading:after {
            content: "";
            display: block;
            width: 60px;
            height: 3px;
            background-color: #d97706;
            margin: 8px auto 0;
        }
        
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-link:after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #d97706;
            transition: width 0.3s ease;
        }
        
        .nav-link:hover:after {
            width: 100%;
        }
        
        .product-card {
            transition: all 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .category-tab {
            transition: all 0.3s ease;
        }
        
        .category-tab.active {
            background-color: #b45309;
            color: white;
        }
        
        .category-tab:hover:not(.active) {
            background-color: #fef3c7;
        }
        
        .gallery {
            display: none;
        }
        
        .gallery.active {
            display: grid;
        }
        
        /* إضافة تأثير تحميل للصور */
        .img-loading {
            position: relative;
            overflow: hidden;
            background-color: #f3f4f6;
        }
        
        .img-loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: loading 1.5s infinite;
            z-index: 1;
        }
        
        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* تنسيق زر التحميل */
        .loading-spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            border: 3px solid rgba(209, 154, 68, 0.3);
            border-radius: 50%;
            border-top-color: #d97706;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* تنسيق إشعار التحميل */
        .loading-message {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            max-width: 24rem;
            margin: 0 auto;
            padding: 1.5rem;
        }

        /* تحسين عرض الصور */
        .product-image {
            width: 100%;
            height: 16rem;
            object-fit: cover;
            object-position: center;
            transition: all 0.5s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }
        
        /* تعديلات اللوغو */
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .site-logo {
            height: auto;
            width: auto;
            /* زيادة حجم الشعار بشكل أكبر في كافة الحالات */
            min-height: 2.5rem; /* 56px */
            max-height: 3.5rem; /* 72px */
            transition: transform 0.3s ease;
        }
        
        .site-logo:hover {
            transform: scale(1.05);
        }
        
        /* إضافة اسم الموقع بجانب الشعار */
        .site-title {
            font-weight: 700;
            color: #92400e; /* amber-800 */
            margin-right: 0.75rem;
            font-size: 1.25rem;
            display: none; /* إخفاء العنوان بشكل افتراضي */
        }

        /* تحسين تجربة الاستخدام على الجوال */
        @media (max-width: 640px) {
            .category-tab {
                padding: 0.5rem 0.75rem;
                font-size: 0.875rem;
            }
            
            .product-image {
                height: 12rem;
            }
            
            /* حجم أكبر للشعار في الموبايل */
            .site-logo {
                min-height: 3.5rem; /* 56px */
                max-height: 5rem; /* 64px */
            }
            
            /* تعديل العناصر الأخرى في الهيدر للموبايل */
            .mobile-header-container {
                padding-left: 0.75rem;
                padding-right: 0.75rem;
            }
        }
        
        /* شاشات متوسطة */
        @media (min-width: 641px) and (max-width: 1024px) {
            .site-logo {
                min-height: 4rem; /* 64px */
                max-height: 4.5rem; /* 72px */
            }
        }
        
        /* شاشات كبيرة */
        @media (min-width: 1025px) {
            .site-title {
                display: block; /* إظهار العنوان في الشاشات الكبيرة */
            }
            
            .site-logo {
                min-height: 4.5rem; /* 72px */
                max-height: 5rem; /* 80px */
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-white text-amber-900 shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center mobile-header-container">
            <div class="flex-shrink-0 logo-container">
                <a href="index.html" class="flex items-center">
                    <!-- الشعار بحجم أكبر -->
                    <img src="b10.png" alt="شعار البيت الدمشقي" class="site-logo"/>
                  </a>
            </div>
            <nav class="hidden md:flex space-x-5 space-x-reverse">
                <a href="index.html#home" class="nav-link px-3 py-2 font-medium hover:text-amber-600 transition">الرئيسية</a>
                <a href="products.html" class="nav-link px-3 py-2 font-medium text-amber-600 border-b-2 border-amber-600">المنتجات</a>
                <a href="index.html#about" class="nav-link px-3 py-2 font-medium hover:text-amber-600 transition">من نحن</a>
                <a href="index.html#location" class="nav-link px-3 py-2 font-medium hover:text-amber-600 transition">موقعنا</a>
            </nav>
            <div class="flex items-center">
                <a href="index.html#contact" class="hidden md:inline-flex items-center bg-amber-50 text-amber-800 hover:bg-amber-100 border border-amber-200 px-4 py-2 rounded-lg font-medium transition duration-300">
                    <i class="fas fa-envelope ml-2"></i>
                    <span>تواصل معنا</span>
                </a>
                <button class="md:hidden text-amber-800 text-xl focus:outline-none" id="mobile-menu-button">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu (Hidden by Default) -->
        <nav class="hidden bg-white md:hidden px-4 py-2 shadow-inner border-t border-amber-100" id="mobile-menu">
            <a href="index.html#home" class="block px-3 py-2 text-amber-900 hover:bg-amber-50 rounded">الرئيسية</a>
            <a href="products.html" class="block px-3 py-2 text-amber-600 bg-amber-50 rounded">المنتجات</a>
            <a href="index.html#about" class="block px-3 py-2 text-amber-900 hover:bg-amber-50 rounded">من نحن</a>
            <a href="index.html#location" class="block px-3 py-2 text-amber-900 hover:bg-amber-50 rounded">موقعنا</a>
            <a href="index.html#contact" class="block px-3 py-2 text-amber-900 hover:bg-amber-50 rounded">تواصل معنا</a>
        </nav>
    </header>

    <!-- Page Title -->
    <section class="bg-gradient-to-b from-amber-50 to-white py-12">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl font-bold text-amber-900 mb-4">منتجاتنا</h1>
            <p class="text-gray-700 max-w-3xl mx-auto mb-8">تشكيلة واسعة من المفروشات السورية الأصيلة المصنوعة يدوياً بحرفية عالية لتضفي لمسة من التراث الدمشقي العريق على منزلك</p>
            <div class="h-1 w-24 bg-amber-600 mx-auto"></div>
        </div>
    </section>

    <!-- Products Categories Tabs -->
    <section class="py-8 bg-white">
        <div class="container mx-auto px-4">
            <div class="flex flex-wrap justify-center gap-2 mb-8" id="category-tabs">
                <button class="category-tab px-5 py-3 bg-amber-100 text-amber-900 rounded-lg font-bold transition shadow-sm" data-category="salah">
                    <i class="fas fa-pray ml-2"></i>
                    سجادة صلاة
                </button>
                <button class="category-tab px-5 py-3 bg-amber-100 text-amber-900 rounded-lg font-bold transition shadow-sm" data-category="lauha">
                    <i class="fas fa-image ml-2"></i>
                    لوحات
                </button>
                <button class="category-tab px-5 py-3 bg-amber-100 text-amber-900 rounded-lg font-bold transition shadow-sm" data-category="carpet">
                    <i class="fas fa-rug ml-2"></i>
                    سجاد
                </button>
                <button class="category-tab px-5 py-3 bg-amber-100 text-amber-900 rounded-lg font-bold transition shadow-sm" data-category="mfrsh">
                    <i class="fas fa-table ml-2"></i>
                    مفارش طاولة
                </button>
                <button class="category-tab px-5 py-3 bg-amber-100 text-amber-900 rounded-lg font-bold transition shadow-sm" data-category="zinah">
                    <i class="fas fa-star ml-2"></i>
                    زينة
                </button>
            </div>
            
            <!-- Category Information -->
            <div class="bg-amber-50 p-6 rounded-lg mb-8 border border-amber-100 shadow-sm text-center">
                <!-- Welcome Message - Will be hidden after category selection -->
                <div id="welcome-message" class="py-8">
                    <i class="fas fa-hand-point-up text-amber-600 text-4xl mb-4"></i>
                    <h2 class="text-2xl font-bold text-amber-900 mb-4">اختر أحد الأصناف لعرض المنتجات</h2>
                    <p class="text-gray-700">يرجى النقر على أحد الأصناف أعلاه لعرض المنتجات المتوفرة</p>
                </div>
                
                <!-- Category Descriptions - Hidden by default -->
                <div id="category-info-salah" class="category-info hidden">
                    <h2 class="text-2xl font-bold text-amber-900 mb-2">سجادة صلاة</h2>
                    <p class="text-gray-700">سجادات صلاة أصيلة بنمط تقليدي مصنوعة يدوياً من أجود أنواع الأقمشة</p>
                    <div class="text-amber-700 mt-4 text-sm">
                        <span id="products-count-salah" class="bg-amber-100 px-3 py-1 rounded-full">32 منتج</span>
                    </div>
                </div>
                <div id="category-info-lauha" class="category-info hidden">
                    <h2 class="text-2xl font-bold text-amber-900 mb-2">لوحات</h2>
                    <p class="text-gray-700">لوحات فنية بتصاميم فريدة مستوحاة من التراث الإسلامي والفن العربي الأصيل</p>
                    <div class="text-amber-700 mt-4 text-sm">
                        <span id="products-count-lauha" class="bg-amber-100 px-3 py-1 rounded-full">95 منتج</span>
                    </div>
                </div>
                <div id="category-info-carpet" class="category-info hidden">
                    <h2 class="text-2xl font-bold text-amber-900 mb-2">سجاد</h2>
                    <p class="text-gray-700">سجاد شرقي أصيل بنقوش تقليدية ومعاصرة منسوج بأنامل حرفيين مهرة</p>
                    <div class="text-amber-700 mt-4 text-sm">
                        <span id="products-count-carpet" class="bg-amber-100 px-3 py-1 rounded-full">43 منتج</span>
                    </div>
                </div>
                <div id="category-info-mfrsh" class="category-info hidden">
                    <h2 class="text-2xl font-bold text-amber-900 mb-2">مفارش طاولة</h2>
                    <p class="text-gray-700">مفارش طاولة مطرزة يدوياً بتصاميم أنيقة تضفي لمسة من الجمال على موائدكم</p>
                    <div class="text-amber-700 mt-4 text-sm">
                        <span id="products-count-mfrsh" class="bg-amber-100 px-3 py-1 rounded-full">69 منتج</span>
                    </div>
                </div>
                <div id="category-info-zinah" class="category-info hidden">
                    <h2 class="text-2xl font-bold text-amber-900 mb-2">زينة</h2>
                    <p class="text-gray-700">قطع زينة تقليدية تعكس أصالة التراث الدمشقي لتزيين منزلك بلمسة من الفن الشرقي</p>
                    <div class="text-amber-700 mt-4 text-sm">
                        <span id="products-count-zinah" class="bg-amber-100 px-3 py-1 rounded-full">14 منتج</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Gallery -->
    <section class="py-8 bg-white mb-12">
        <div class="container mx-auto px-4">
            <!-- Loading Indicator - Initially Hidden -->
            <div id="loading-indicator" class="py-16 text-center hidden">
                <div class="loading-message inline-block">
                    <div class="loading-spinner mb-4 mx-auto"></div>
                    <p class="text-amber-900 font-medium">جاري تحميل المنتجات...</p>
                    <p class="text-gray-500 text-sm mt-2">يرجى الانتظار قليلاً</p>
                </div>
            </div>
            
            <!-- Product Galleries for Each Category - All Initially Hidden -->
            <div id="gallery-salah" class="gallery grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 hidden">
                <!-- سيتم إضافة بطاقات المنتجات ديناميكياً -->
            </div>
            
            <div id="gallery-lauha" class="gallery grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 hidden">
                <!-- سيتم إضافة بطاقات المنتجات ديناميكياً -->
            </div>
            
            <div id="gallery-carpet" class="gallery grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 hidden">
                <!-- سيتم إضافة بطاقات المنتجات ديناميكياً -->
            </div>
            
            <div id="gallery-mfrsh" class="gallery grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 hidden">
                <!-- سيتم إضافة بطاقات المنتجات ديناميكياً -->
            </div>
            
            <div id="gallery-zinah" class="gallery grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 hidden">
                <!-- سيتم إضافة بطاقات المنتجات ديناميكياً -->
            </div>

            <!-- Error Message - Initially Hidden -->
            <div id="error-message" class="py-16 text-center hidden">
                <div class="loading-message inline-block">
                    <div class="text-amber-700 mb-4">
                        <i class="fas fa-exclamation-triangle text-4xl"></i>
                    </div>
                    <p class="text-amber-900 font-bold">حدث خطأ أثناء تحميل المنتجات</p>
                    <p class="text-gray-600 mt-2" id="error-details">يرجى المحاولة مرة أخرى</p>
                    <button onclick="retryLoadingCategory()" class="mt-6 bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition">
                        إعادة المحاولة
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-16 bg-amber-50 arabic-pattern">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl font-bold text-amber-900 mb-6">هل أعجبتك منتجاتنا؟</h2>
            <p class="text-gray-700 mb-8 max-w-2xl mx-auto">تواصل معنا الآن للحصول على المزيد من المعلومات حول منتجاتنا أو لطلب قطع مخصصة تناسب ذوقك</p>
            <div class="flex flex-wrap justify-center gap-4">
                <a href="index.html#contact" class="bg-amber-700 hover:bg-amber-600 text-white font-bold py-3 px-6 rounded-lg inline-flex items-center transition duration-300 shadow-md">
                    <i class="fas fa-envelope ml-2"></i>
                    <span>تواصل معنا</span>
                </a>
                <a href="index.html#location" class="bg-white hover:bg-amber-50 text-amber-800 font-bold py-3 px-6 rounded-lg inline-flex items-center transition duration-300 border border-amber-200 shadow-sm">
                    <i class="fas fa-map-marker-alt ml-2"></i>
                    <span>زيارة متجرنا</span>
                </a>
            </div>
        </div>
    </section>

     <!-- Footer -->
<footer class="bg-amber-900 text-white pt-12 pb-6">
    <div class="container mx-auto px-4">
        <div class="flex flex-wrap">
            <!-- Logo & About -->
            <div class="w-full md:w-1/3 mb-8 md:mb-0">
                <!-- إضافة الشعار في الفوتر أيضاً -->
                <div class="mb-4">
                    <img src="b10.png" alt="شعار البيت الدمشقي" class="h-16 w-auto"/>
                </div>
                <p class="text-amber-200 mb-6 max-w-xs">نحن متجر متخصص في المفروشات السورية التقليدية المصنوعة يدوياً بجودة عالية من قلب دمشق القديمة.</p>
                <div class="flex space-x-4 space-x-reverse">
                    <a href="#" class="text-white hover:text-amber-200 transition">
                        <i class="fab fa-facebook-f text-lg"></i>
                    </a>
                    <a href="#" class="text-white hover:text-amber-200 transition">
                        <i class="fab fa-instagram text-lg"></i>
                    </a>
                    <a href="#" class="text-white hover:text-amber-200 transition">
                        <i class="fab fa-whatsapp text-lg"></i>
                    </a>
                    <a href="#" class="text-white hover:text-amber-200 transition">
                        <i class="fab fa-telegram text-lg"></i>
                    </a>
                </div>
            </div>
            
            <!-- Links -->
            <div class="w-full md:w-1/3 mb-8 md:mb-0">
                <h3 class="text-lg font-bold mb-6 border-b border-amber-800 pb-2">روابط سريعة</h3>
                <div class="grid grid-cols-2">
                    <div>
                        <ul class="space-y-3">
                            <li>
                                <a href="#home" class="hover:text-amber-200 transition inline-flex items-center">
                                    <i class="fas fa-chevron-left text-xs ml-1 text-amber-500"></i>
                                    <span>الرئيسية</span>
                                </a>
                            </li>
                            <li>
                                <a href="product.html" class="hover:text-amber-200 transition inline-flex items-center">
                                    <i class="fas fa-chevron-left text-xs ml-1 text-amber-500"></i>
                                    <span>المنتجات</span>
                                </a>
                            </li>
                            <li>
                                <a href="#about" class="hover:text-amber-200 transition inline-flex items-center">
                                    <i class="fas fa-chevron-left text-xs ml-1 text-amber-500"></i>
                                    <span>من نحن</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <ul class="space-y-3">
                            <li>
                                <a href="#location" class="hover:text-amber-200 transition inline-flex items-center">
                                    <i class="fas fa-chevron-left text-xs ml-1 text-amber-500"></i>
                                    <span>موقعنا</span>
                                </a>
                            </li>
                            <li>
                                <a href="#contact" class="hover:text-amber-200 transition inline-flex items-center">
                                    <i class="fas fa-chevron-left text-xs ml-1 text-amber-500"></i>
                                    <span>تواصل معنا</span>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="hover:text-amber-200 transition inline-flex items-center">
                                    <i class="fas fa-chevron-left text-xs ml-1 text-amber-500"></i>
                                    <span>الشروط والأحكام</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Contact Info -->
            <div class="w-full md:w-1/3">
                <h3 class="text-lg font-bold mb-6 border-b border-amber-800 pb-2">معلومات الاتصال</h3>
                <ul class="space-y-4">
                    <li class="flex items-start">
                        <i class="fas fa-map-marker-alt text-amber-500 ml-3 mt-1"></i>
                        <span>سوق الحميدية، بالقرب من قلعة دمشق، دمشق، سوريا</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-phone-alt text-amber-500 ml-3 mt-1"></i>
                        <div>
                            <p dir="ltr">+963 953 503 185</p>
                            <p dir="ltr">+963 957 595 601</p>
                            <p dir="ltr">+963 932 932 532</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-envelope text-amber-500 ml-3 mt-1"></i>
                        <span>alhsynybdalrazaq3@gmail.com</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-clock text-amber-500 ml-3 mt-1"></i>
                        <div>
                            <p>السبت - الخميس: ٩ص - ٧م</p>
                            <p>الجمعة: ٢ظ - ٧م</p>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="border-t border-amber-800 mt-8 pt-6 text-center">
            <p class="text-amber-200 text-sm">جميع الحقوق محفوظة &copy; ٢٠٢٥ البيت الدمشقي - المفروشات السورية</p>
        </div>
    </div>
</footer>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="fixed bottom-6 right-6 bg-amber-700 text-white w-10 h-10 rounded-full flex items-center justify-center shadow-lg opacity-0 invisible transition-all duration-300 z-50 hover:bg-amber-600">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- كود JavaScript -->
    <script>
        // ===================================
        // الإعدادات والمتغيرات العامة
        // ===================================
        
        // قائمة بالفئات ومعلوماتها
        const categories = [
            { id: 'salah', title: 'سجادة صلاة', count: 32, icon: 'pray', defaultDesc: 'سجادة صلاة بنمط تقليدي' },
            { id: 'lauha', title: 'لوحة فنية', count: 95, icon: 'image', defaultDesc: 'لوحة فنية بتصميم فريد' },
            { id: 'carpet', title: 'سجادة', count: 43, icon: 'rug', defaultDesc: 'سجادة شرقية أصيلة' },
            { id: 'mfrsh', title: 'مفرش طاولة', count: 69, icon: 'table', defaultDesc: 'مفرش طاولة مطرز يدوياً' },
            { id: 'zinah', title: 'قطعة زينة', count: 14, icon: 'star', defaultDesc: 'قطعة زينة تقليدية' }
        ];
        
        // الإعدادات العامة
        const config = {
            itemsPerPage: 12, // عدد المنتجات في كل صفحة (0 لعرض جميع المنتجات)
            configFileName: 'config.json', // اسم ملف التكوين في كل مجلد
            fallbackImage: './placeholder.jpg', // صورة بديلة في حالة عدم وجود الصورة (صورة محلية)
            lazyLoadImages: true, // تحميل الصور بشكل متأخر (تحسين الأداء)
            imageExtensions: ['jpg', 'jpeg', 'png', 'gif'], // امتدادات الصور المدعومة
            debug: true // تفعيل رسائل التصحيح في وحدة التحكم
        };

        // متغيرات لإدارة عرض المنتجات
        let productData = {}; // بيانات المنتجات من كل المجلدات
        let loadedCategories = []; // الفئات التي تم تحميلها بالفعل
        let currentCategory = null; // الفئة الحالية المعروضة
        let currentPage = {}; // الصفحة الحالية لكل فئة
        let isLoading = false; // للتحكم في عملية التحميل
        
        // تهيئة المتغيرات
        categories.forEach(category => {
            currentPage[category.id] = 1;
        });
        
        // ===================================
        // دوال تحميل البيانات
        // ===================================
        
        // دالة لتحميل ملف التكوين (config.json) من مجلد معين
        async function loadCategoryConfig(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (!category) return [];
            
            try {
                logDebug(`تحميل ملف التكوين للمجلد: ${categoryId}`);
                
                // إظهار مؤشر التحميل
                showLoading(true);
                
                const response = await fetch(`${categoryId}/${config.configFileName}`);
                
                if (!response.ok) {
                    throw new Error(`فشل تحميل ملف التكوين (${response.status}): ${categoryId}/${config.configFileName}`);
                }
                
                const configData = await response.json();
                
                // التحقق من صحة البيانات
                if (!configData.products || !Array.isArray(configData.products)) {
                    throw new Error('تنسيق ملف التكوين غير صحيح');
                }
                
                // إضافة مسار المجلد للصور إذا لم يكن موجوداً
                return configData.products.map(product => {
                    // إذا كان مسار الصورة لا يحتوي على اسم المجلد، نضيفه
                    if (product.image && !product.image.startsWith(categoryId)) {
                        product.image = `${categoryId}/${product.image}`;
                    }
                    return product;
                });
            } catch (error) {
                logDebug(`خطأ في تحميل ملف التكوين للمجلد ${categoryId}:`, error);
                
                // محاولة تحميل الصور مباشرة
                return await generateProductsByImageCheck(categoryId);
            } finally {
                // إخفاء مؤشر التحميل
                showLoading(false);
            }
        }
        
        // دالة لإنشاء بيانات المنتج بناءً على التحقق من وجود الصور
        async function generateProductsByImageCheck(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (!category) return [];
            
            logDebug(`محاولة اكتشاف الصور في المجلد ${categoryId}`);
            
            const products = [];
            
            // محاولة فحص وجود الصور بجميع الامتدادات المدعومة
            for (let i = 1; i <= category.count; i++) {
                let imageFound = false;
                let foundExtension = null;
                
                // التحقق من كل امتداد
                for (const ext of config.imageExtensions) {
                    const imagePath = `${categoryId}/${i}.${ext}`;
                    try {
                        const exists = await checkImageExists(imagePath);
                        if (exists) {
                            imageFound = true;
                            foundExtension = ext;
                            break;
                        }
                    } catch (err) {
                        logDebug(`خطأ في التحقق من الصورة ${imagePath}:`, err);
                    }
                }
                
                // إذا تم العثور على الصورة، أضف بيانات المنتج
                if (imageFound) {
                    products.push({
                        id: `${categoryId}-${i}`,
                        image: `${categoryId}/${i}.${foundExtension}`,
                        title: `${category.title} ${i}`,
                        shortDesc: category.defaultDesc
                    });
                } else {
                    // محاولة إضافة المنتج مع امتداد افتراضي
                    products.push({
                        id: `${categoryId}-${i}`,
                        image: `${categoryId}/${i}.jpg`, // امتداد افتراضي
                        title: `${category.title} ${i}`,
                        shortDesc: category.defaultDesc
                    });
                }
            }
            
            return products;
        }
        
        // دالة للتحقق من وجود الصورة
        function checkImageExists(imagePath) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = imagePath;
            });
        }
        
        // دالة لتحميل بيانات منتجات فئة معينة
        async function loadCategoryProducts(categoryId) {
            if (isLoading) return; // تجنب التحميل المتكرر
            isLoading = true;
            
            try {
                // تحقق مما إذا كانت الفئة محملة بالفعل
                if (loadedCategories.includes(categoryId) && productData[categoryId]) {
                    // الفئة محملة بالفعل، فقط قم بعرضها
                    displayCategoryProducts(categoryId);
                    return;
                }
                
                // إظهار مؤشر التحميل وإخفاء رسالة الخطأ
                showLoading(true);
                hideError();
                
                // تحميل بيانات الفئة
                const products = await loadCategoryConfig(categoryId);
                
                // تخزين البيانات
                productData[categoryId] = products;
                
                // إضافة الفئة إلى قائمة الفئات المحملة
                if (!loadedCategories.includes(categoryId)) {
                    loadedCategories.push(categoryId);
                }
                
                // عرض المنتجات
                displayCategoryProducts(categoryId);
            } catch (error) {
                logDebug(`خطأ في تحميل منتجات الفئة ${categoryId}:`, error);
                showError(`حدث خطأ أثناء تحميل المنتجات: ${error.message}`);
            } finally {
                isLoading = false;
                showLoading(false);
            }
        }

        // ===================================
        // دوال عرض المنتجات
        // ===================================
        
        // دالة لإنشاء بطاقة منتج واحد
        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition';
            
            card.innerHTML = `
                <div class="relative overflow-hidden">
                    <div class="img-loading w-full h-64">
                        <img src="${product.image}" alt="${product.title}" 
                            class="product-image w-full h-full object-cover transition-transform duration-500"
                            onerror="this.onerror=null; this.src='${config.fallbackImage}'; this.alt='صورة غير متوفرة'; this.parentNode.classList.remove('img-loading');"
                            onload="this.parentNode.classList.remove('img-loading');"
                            ${config.lazyLoadImages ? 'loading="lazy"' : ''}
                        />
                    </div>
                </div>
                <div class="p-4">
                    <h3 class="text-lg font-bold text-amber-900 mb-2">${product.title}</h3>
                    <p class="text-gray-700 text-sm mb-4">${product.shortDesc}</p>
                    <a href="index.html#contact" class="bg-amber-50 hover:bg-amber-100 text-amber-800 py-2 px-4 rounded-full inline-flex items-center justify-center transition duration-200 border border-amber-200 w-full">
                        <span>استفسار</span>
                        <i class="fas fa-envelope mr-2"></i>
                    </a>
                </div>
            `;
            
            return card;
        }
        
        // دالة لعرض منتجات فئة معينة
        function displayCategoryProducts(categoryId) {
            const products = productData[categoryId] || [];
            
            // الحصول على عناصر DOM
            const galleryEl = document.getElementById(`gallery-${categoryId}`);
            
            // تحديث عداد المنتجات
            const countEl = document.getElementById(`products-count-${categoryId}`);
            if (countEl) {
                countEl.textContent = `${products.length} منتج`;
            }
            
            // تفريغ المعرض
            galleryEl.innerHTML = '';
            
            // التحقق من وجود منتجات
            if (products.length === 0) {
                galleryEl.innerHTML = '<div class="col-span-full text-center py-12 text-gray-500">لا توجد منتجات في هذه الفئة حالياً</div>';
                return;
            }
            
            // حساب المنتجات التي سيتم عرضها في الصفحة الحالية
            const page = currentPage[categoryId] || 1;
            let productsToShow = products;
            
            if (config.itemsPerPage > 0) {
                const startIndex = (page - 1) * config.itemsPerPage;
                const endIndex = Math.min(startIndex + config.itemsPerPage, products.length);
                productsToShow = products.slice(startIndex, endIndex);
            }
            
            // إنشاء وإضافة بطاقات المنتجات
            productsToShow.forEach(product => {
                const productCard = createProductCard(product);
                galleryEl.appendChild(productCard);
            });
            
            // تحديث الفئة الحالية
            currentCategory = categoryId;
            
            // إخفاء رسالة الترحيب
            document.getElementById('welcome-message').classList.add('hidden');
            
            // إظهار معرض المنتجات
            showActiveCategory();
        }
        
        // دالة لإظهار معرض الفئة النشطة فقط
        function showActiveCategory() {
            // إخفاء جميع معارض المنتجات
            document.querySelectorAll('.gallery').forEach(gallery => {
                gallery.classList.remove('active');
                gallery.classList.add('hidden');
            });
            
            // إخفاء جميع معلومات الفئات
            document.querySelectorAll('.category-info').forEach(info => {
                info.classList.add('hidden');
            });
            
            if (currentCategory) {
                // إظهار المعرض النشط
                const gallery = document.getElementById(`gallery-${currentCategory}`);
                if (gallery) {
                    gallery.classList.remove('hidden');
                    gallery.classList.add('active');
                }
                
                // إظهار معلومات الفئة النشطة
                const categoryInfo = document.getElementById(`category-info-${currentCategory}`);
                if (categoryInfo) {
                    categoryInfo.classList.remove('hidden');
                }
                
                // تحديث حالة التبويبات
                updateTabsStatus(currentCategory);
            }
        }
        
        // تحديث حالة تبويبات الفئات
        function updateTabsStatus(activeCategory) {
            document.querySelectorAll('.category-tab').forEach(tab => {
                const category = tab.getAttribute('data-category');
                
                // إزالة حالة النشاط من جميع التبويبات
                tab.classList.remove('active');
                tab.classList.remove('bg-amber-700');
                tab.classList.remove('text-white');
                tab.classList.add('bg-amber-100');
                tab.classList.add('text-amber-900');
                
                // إضافة حالة النشاط للتبويب المحدد
                if (category === activeCategory) {
                    tab.classList.add('active');
                    tab.classList.add('bg-amber-700');
                    tab.classList.add('text-white');
                    tab.classList.remove('bg-amber-100');
                    tab.classList.remove('text-amber-900');
                }
            });
        }
        
        // إظهار/إخفاء مؤشر التحميل
        function showLoading(show) {
            const loadingIndicator = document.getElementById('loading-indicator');
            if (show) {
                loadingIndicator.classList.remove('hidden');
            } else {
                loadingIndicator.classList.add('hidden');
            }
        }
        
        // إظهار رسالة خطأ
        function showError(message) {
            const errorElement = document.getElementById('error-message');
            const errorDetailsElement = document.getElementById('error-details');
            
            errorDetailsElement.textContent = message || 'يرجى المحاولة مرة أخرى';
            errorElement.classList.remove('hidden');
        }
        
        // إخفاء رسالة الخطأ
        function hideError() {
            const errorElement = document.getElementById('error-message');
            errorElement.classList.add('hidden');
        }
        
        // دالة لإعادة محاولة تحميل الفئة الحالية
        function retryLoadingCategory() {
            if (currentCategory) {
                loadCategoryProducts(currentCategory);
            }
        }
        
        // دالة لطباعة رسائل التصحيح
        function logDebug(...args) {
            if (config.debug) {
                console.log(...args);
            }
        }

        // ===================================
        // دوال إدارة واجهة المستخدم
        // ===================================
        
        // دالة لتهيئة عناصر واجهة المستخدم
        function initUIElements() {
            // تبديل القائمة في الهاتف المحمول
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            
            mobileMenuButton.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });
            
            // زر العودة إلى الأعلى
            const backToTopButton = document.getElementById('back-to-top');
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopButton.classList.remove('opacity-0', 'invisible');
                    backToTopButton.classList.add('opacity-100', 'visible');
                } else {
                    backToTopButton.classList.add('opacity-0', 'invisible');
                    backToTopButton.classList.remove('opacity-100', 'visible');
                }
            });
            
            backToTopButton.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // علامات تبويب الفئات
            const categoryTabs = document.querySelectorAll('.category-tab');
            
            categoryTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const categoryId = tab.getAttribute('data-category');
                    if (categoryId) {
                        // تحميل وعرض المنتجات للفئة المحددة
                        loadCategoryProducts(categoryId);
                    }
                });
            });
        }

        // ===================================
        // تشغيل الكود عند تحميل الصفحة
        // ===================================
        
        // دالة تهيئة الصفحة
        function initializePage() {
            logDebug('تهيئة صفحة المنتجات...');
            
            // تهيئة عناصر واجهة المستخدم
            initUIElements();
            
            // لا نقوم بتحميل أي منتجات تلقائياً - ننتظر حتى يختار المستخدم فئة
        }
        
        // تهيئة الصفحة عند اكتمال تحميل DOM
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>